import{j as s}from"./ui-DskC_GZ4.js";import{T as K,a as _,b as x,c as p}from"./tabs-DPPu6Y5N.js";import{C as v,a as w,b as M,c as G,d as U}from"./card-BKNPTKQ9.js";import{A as $}from"./arrow-up-right-DVmJcFtH.js";import{c as L,af as H,T as l,U as I,a5 as V,Q as X}from"./index-fU-TRYU7.js";import{R as P,P as Y,a as Z,C as z,T,L as Q,b as A,X as R,Y as k,d as q,B as W,e as O}from"./charts-DDg0wrp5.js";import{r as D}from"./vendor-BlHcAAdO.js";import"./supabase-C9Ps4N4y.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=L("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=L("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]),b=({title:t,value:e,icon:i,change:a,trend:n,loading:r=!1})=>s.jsx(v,{children:s.jsxs(w,{className:"pt-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t}),r?s.jsx("div",{className:"h-8 w-16 bg-gray-200 animate-pulse rounded mt-1"}):s.jsx("p",{className:"text-2xl font-bold",children:e.toLocaleString()})]}),s.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:i})]}),!r&&s.jsxs("div",{className:"flex items-center mt-4",children:[s.jsxs("div",{className:`flex items-center text-sm ${n==="up"?"text-green-600":"text-red-600"}`,children:[n==="up"?s.jsx($,{className:"h-4 w-4 mr-1"}):s.jsx(ss,{className:"h-4 w-4 mr-1"}),s.jsxs("span",{children:[a,"%"]})]}),s.jsx("span",{className:"text-xs text-muted-foreground ml-1.5",children:"vs. last month"})]})]})}),S=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"],ts=t=>{const{cx:e,cy:i,midAngle:a,innerRadius:n,outerRadius:r,name:d,percent:h}=t,y=n+(r-n)*.5,f=e+y*Math.cos(-a*Math.PI/180),u=i+y*Math.sin(-a*Math.PI/180),m=d!=null?String(d):"";return s.jsx("text",{x:f,y:u,fill:"white",textAnchor:f>e?"start":"end",dominantBaseline:"central",children:`${m}: ${(h*100).toFixed(0)}%`})},j=({data:t,loading:e,title:i,description:a,type:n,dataKey:r="value"})=>s.jsxs(v,{children:[s.jsxs(M,{children:[s.jsx(G,{children:i}),s.jsx(U,{children:a})]}),s.jsx(w,{children:e?s.jsx("div",{className:"flex justify-center items-center h-[300px]",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-pet-primary"})}):s.jsx(P,{width:"100%",height:300,children:n==="pie"?s.jsxs(Y,{children:[s.jsx(Z,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:r,label:ts,children:t.map((d,h)=>s.jsx(z,{fill:S[h%S.length]},`cell-${h}`))}),s.jsx(T,{})]}):s.jsxs(Q,{data:t,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(A,{strokeDasharray:"3 3"}),s.jsx(R,{dataKey:"month"}),s.jsx(k,{}),s.jsx(T,{}),s.jsx(q,{type:"monotone",dataKey:r,stroke:"#8884d8",activeDot:{r:8}})]})})})]}),rs=({loading:t,dashboardData:e})=>{const i=e.monthlyUsers.map((a,n)=>{var r;return{month:a.month,users:a.users,orders:((r=e.monthlyOrders[n])==null?void 0:r.orders)||0}});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(j,{data:e.petTypeDistribution,loading:t,title:"Pet Type Distribution",description:"Types of pets registered on the platform",type:"pie"}),s.jsx(j,{data:e.planDistribution,loading:t,title:"User Plan Distribution",description:"Breakdown of subscription plans",type:"pie"}),s.jsx(j,{data:e.monthlyScans,loading:t,title:"Monthly Pet Tag Scans",description:"Tag scan activity over time",type:"line",dataKey:"scans"}),s.jsx(j,{data:e.lostFoundStatusDistribution,loading:t,title:"Lost & Found Report Status",description:"Status of lost & found reports",type:"pie"})]}),s.jsxs(v,{children:[s.jsxs(M,{children:[s.jsx(G,{children:"Monthly Overview"}),s.jsx(U,{children:"Monthly growth of users, pets and orders"})]}),s.jsx(w,{children:t?s.jsx("div",{className:"flex justify-center items-center h-[300px]",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-pet-primary"})}):s.jsx(P,{width:"100%",height:300,children:s.jsxs(W,{data:i,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(A,{strokeDasharray:"3 3"}),s.jsx(R,{dataKey:"month"}),s.jsx(k,{}),s.jsx(T,{}),s.jsx(O,{dataKey:"users",name:"Users",fill:"#8884d8"}),s.jsx(O,{dataKey:"orders",name:"Orders",fill:"#82ca9d"})]})})})]})]})},os=({loading:t,monthlyUsers:e})=>s.jsxs(v,{children:[s.jsxs(M,{children:[s.jsx(G,{children:"User Growth"}),s.jsx(U,{children:"Monthly user registration trend"})]}),s.jsx(w,{children:s.jsx(j,{data:e,loading:t,title:"",description:"",type:"line",dataKey:"users"})})]}),as=()=>{const{toast:t}=H(),[e,i]=D.useState(!0),[a,n]=D.useState({userCount:0,petCount:0,lostFoundCount:0,orderCount:0,recentUsers:[],recentPets:[],userGrowth:0,petGrowth:0,lostFoundGrowth:0,orderGrowth:0,petTypeDistribution:[],planDistribution:[],monthlyScans:[],monthlyUsers:[],monthlyOrders:[],lostFoundStatusDistribution:[]}),r=async()=>{i(!0);try{const[{count:d},{count:h},{count:y},{count:f}]=await Promise.all([l.from("users").select("*",{count:"exact",head:!0}),l.from("pets").select("*",{count:"exact",head:!0}),l.from("lost_found_posts").select("*",{count:"exact",head:!0}),l.from("store_orders").select("*",{count:"exact",head:!0})]),{data:u}=await l.from("pets").select("type"),m={};u==null||u.forEach(o=>{m[o.type]=(m[o.type]||0)+1});const E=Object.entries(m).map(([o,c])=>({name:o,value:c})),{data:g}=await l.from("users").select("plan"),C={};g==null||g.forEach(o=>{C[o.plan]=(C[o.plan]||0)+1});const B=Object.entries(C).map(([o,c])=>({name:o,value:c})),{data:N}=await l.from("lost_found_posts").select("status"),F={open:0,resolved:0,closed:0};N==null||N.forEach(o=>{const c=o.status;c in F&&(F[c]+=1)});const J=Object.entries(F).map(([o,c])=>({name:o,value:c}));n({userCount:d||0,petCount:h||0,lostFoundCount:y||0,orderCount:f||0,recentUsers:[],recentPets:[],userGrowth:15,petGrowth:8,lostFoundGrowth:12,orderGrowth:5,petTypeDistribution:E,planDistribution:B,monthlyScans:[{month:"Jan",scans:12},{month:"Feb",scans:19},{month:"Mar",scans:25},{month:"Apr",scans:32},{month:"May",scans:28},{month:"Jun",scans:40}],monthlyUsers:[{month:"Jan",users:5},{month:"Feb",users:8},{month:"Mar",users:12},{month:"Apr",users:15},{month:"May",users:20},{month:"Jun",users:25}],monthlyOrders:[{month:"Jan",orders:2},{month:"Feb",orders:4},{month:"Mar",orders:8},{month:"Apr",orders:6},{month:"May",orders:10},{month:"Jun",orders:12}],lostFoundStatusDistribution:J})}catch(d){console.error("Error fetching dashboard data:",d),t({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}finally{i(!1)}};return D.useEffect(()=>{r()},[]),{loading:e,dashboardData:a,fetchDashboardData:r}},xs=()=>{const{loading:t,dashboardData:e}=as();return s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(b,{title:"Total Users",value:e.userCount,icon:s.jsx(I,{className:"h-5 w-5"}),change:e.userGrowth,trend:e.userGrowth>=0?"up":"down",loading:t}),s.jsx(b,{title:"Registered Pets",value:e.petCount,icon:s.jsx(V,{className:"h-5 w-5"}),change:e.petGrowth,trend:e.petGrowth>=0?"up":"down",loading:t}),s.jsx(b,{title:"Lost & Found Reports",value:e.lostFoundCount,icon:s.jsx(es,{className:"h-5 w-5"}),change:e.lostFoundGrowth,trend:e.lostFoundGrowth>=0?"up":"down",loading:t}),s.jsx(b,{title:"Store Orders",value:e.orderCount,icon:s.jsx(X,{className:"h-5 w-5"}),change:e.orderGrowth,trend:e.orderGrowth>=0?"up":"down",loading:t})]}),s.jsxs(K,{defaultValue:"overview",className:"space-y-6",children:[s.jsxs(_,{children:[s.jsx(x,{value:"overview",children:"Overview"}),s.jsx(x,{value:"users",children:"Users"}),s.jsx(x,{value:"pets",children:"Pets"}),s.jsx(x,{value:"lostfound",children:"Lost & Found"}),s.jsx(x,{value:"orders",children:"Orders"})]}),s.jsx(p,{value:"overview",children:s.jsx(rs,{loading:t,dashboardData:e})}),s.jsx(p,{value:"users",children:s.jsx(os,{loading:t,monthlyUsers:e.monthlyUsers})}),s.jsx(p,{value:"pets",children:s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Pet statistics dashboard coming soon"})}),s.jsx(p,{value:"lostfound",children:s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Lost & Found statistics dashboard coming soon"})}),s.jsx(p,{value:"orders",children:s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Orders statistics dashboard coming soon"})})]})]})};export{xs as default};
